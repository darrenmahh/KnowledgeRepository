

本文档旨在提供一份详细的操作指南，以复现《基于机器学习的青藏高原总初级生产力估算研究》中的核心工作。整个流程分为四个主要阶段。

### 0.1.1 **阶段一：数据准备与预处理**

此阶段是所有后续分析的基础，核心目标是收集并处理好所有必需的数据，确保时空维度的一致性。

**1. 收集数据源**

|数据类型|数据名称/来源|具体内容/需求|
|---|---|---|
|**涡度通量GPP**|FLUXNET2015, ChinaFLUX, 国家青藏高原科学数据中心|筛选论文中指定的14个站点（如阿里、阿柔、当雄等），获取日尺度GPP实测数据。|
|**气象数据**|国家青藏高原科学数据中心：中国区域地面气象要素驱动数据集|获取近地面气温(TEMP)、降水率(PREC)、地面向下短波辐射(SSRD)。|
|**植被数据**|全球陆表特征参量数据产品 (GLASS)|获取叶面积指数(LAI)产品，版本V6。|
|**土地覆盖类型**|MODIS (MCD12Q1) 产品|获取IGBP分类方案下的土地覆盖类型数据。|
|**高程数据**|地理空间数据云 (GDEMV3 90M)|DEM数据，用于研究区背景制图和分析。|
|**对比GPP产品**|EC_LUE_GPP, FLUXSAT_GPP, GLASS_GPP, NIRv_GPP|用于最终结果的交叉验证。|

**2. 数据预处理**

- **设定研究时段**：统一所有数据的时间范围为 **2000年1月1日 至 2018年12月31日**。
    
- **统一时空分辨率**：
    
    - **目标分辨率**：**日尺度，500米**。
        
    - **气象数据**：
        
        1. **时间聚合**：将原始的3小时间隔数据处理为日尺度数据（例如：日均温、日累计降水、日累计辐射）。
            
        2. **空间插值**：使用双线性插值或更高级的降尺度方法，将原始的0.1度 (~10km) 分辨率插值到500米。
            
    - **LAI数据**：
        
        1. **时间插补**：将逐8天的数据线性插值或重复填充，生成日尺度数据。
            
- **站点数据提取**：
    
    1. 对收集到的14个站点GPP数据进行质量控制，剔除异常值。
        
    2. 根据每个站点的经纬度，从预处理好的气象、LAI和土地覆盖类型栅格数据中，提取对应像元的日值序列。
        

### 0.1.2 **阶段二：基于LSTM的站点数据扩充**

此阶段是研究的第一个核心创新点，旨在通过模型模拟，解决站点观测时间序列短的问题。

**1. 筛选扩充站点**

- 从14个站点中，选择数据质量好、观测年份相对较多的站点进行数据扩充。论文中选择了 **6个** 站点：`当雄`、`海北高山西藏遗址`、`海北灌木林`、`海北湿地`、`那曲`、`申扎`。
    

**2. 构建并训练LSTM模型**

- **模型结构**：搭建一个多变量输入的LSTM（Long Short-Term Memory）网络。
    
- **输入特征 (X)**：对于每个待扩充站点，使用其 **已有观测时段内** 的 `日GPP`、`日LAI`、`日TEMP`、`日PREC`、`日SSRD` 时间序列作为输入。
    
- **目标变量 (Y)**：预测下一时间步的 `日GPP`。
    
- **训练**：在每个站点的已有数据上分别训练LSTM模型，让模型学习GPP与各驱动因子之间的动态和时滞关系。
    

**3. 模拟扩充GPP序列**

- 利用训练好的LSTM模型，输入该站点在整个 **2000-2018年** 期间完整的LAI和气象数据序列，来预测（或称“后报”）其在缺失年份的日GPP值。
    
- 将模拟生成的GPP数据与原始观测数据拼接，形成覆盖2000-2018年的完整日GPP序列。
    

**4. 验证扩充效果**

- **交叉验证**：采用 **K折交叉验证（K=5）**，并重复 **100次** 以获得稳健的评估结果。
    
- **对比分析**：
    
    1. **精度对比**：在 **单个站点**、**6个扩充站点的集合**、**全部14个站点的集合** 这三个层次上，分别计算和比较 **使用LSTM扩充后** (`LSTM模型`) 与 **仅使用原始稀疏数据** (`nonLSTM模型`) 的预测精度。评估指标为 **决定系数 (R²)** 和 **均方根误差 (RMSE)**。
        
    2. **贡献率对比**：使用随机森林等方法，分析扩充前后，各输入变量（LAI、TEMP等）对GPP估算的相对重要性，验证扩充过程是否保持了合理的物理逻辑。
        

### 0.1.3 **阶段三：基于RF的区域GPP升尺度估算**

此阶段是研究的第二个核心创新点，将点上的信息扩展到整个青藏高原区域。

**1. 构建空间模型训练集**

- **目标变量 (Y)**：使用 **全部14个站点** 的完整GPP日值序列（包括原始观测和LSTM扩充部分）。
    
- **特征变量 (X)**：使用这些站点在对应日期的 **LAI、TEMP、PREC、SSRD以及土地覆盖类型** 的值。
    

**2. 训练随机森林 (RF) 模型**

- 使用上述构建的训练数据集，训练一个随机森林回归模型。该模型将学习GPP与这五个驱动因子之间的非线性映射关系。
    

**3. 生成QTP_GPP数据集**

- **空间预测**：将训练好的RF模型，应用于整个青藏高原区域。输入覆盖全区、2000-2018年、每日、500米分辨率的 `LAI`、`TEMP`、`PREC`、`SSRD` 和 `土地覆盖类型` 栅格数据。
    
- **最终产品**：模型将逐像元、逐日地估算出GPP值，最终生成本研究的核心成果—— **QTP_GPP数据集**。
    

### 0.1.4 **阶段四：结果分析与交叉验证**

此阶段是对最终生成的QTP_GPP数据集进行全面、系统的评估。

**1. QTP_GPP数据集自身分析**

- **站点验证**：将QTP_GPP数据集中对应站点的GPP估算值，与 **原始的、未参与训练的** 站点实测GPP进行对比，计算R²和RMSE。
    
- **时空格局分析**：
    
    - **空间分布**：绘制多年、分季、分月的平均GPP空间分布图。
        
    - **时间趋势**：绘制年GPP总量、月均GPP的时间序列变化图，分析其长期趋势。
        
    - **变化趋势分析**：计算并绘制2000-2018年GPP、LAI及各气象因子的空间变化趋势图（Slope图）。
        

**2. 归因与敏感性分析**

- **相关性分析**：计算GPP与LAI、PREC、SSRD、TEMP在像元尺度上的相关系数，并绘制空间分布图。
    
- **敏感性分析**：
    
    1. **设置情景**：运行RF模型多次。一次为正常驱动（所有变量都随时间变化），其他几次则每次固定一个变量（如LAI）为2000年的初始状态不变。
        
    2. **定量归因**：通过比较不同情景下GPP的长期变化趋势，定量分离出每个驱动因子对GPP变化的贡献。
        

**3. 多源GPP产品交叉比较**

- **时空重采样**：将QTP_GPP以及其他四套对比数据集（EC_LUE_GPP等）统一重采样到 **月尺度、0.05度分辨率**。
    
- **全方位对比**：
    
    - **站点精度**：比较五套产品在通量站点上的精度。
        
    - **时间总量**：比较五套产品在年GPP总量上的差异和趋势。
        
    - **空间格局**：绘制五套产品的空间分布图、两两之间的差值图和相关性图。
        
    - **变化趋势**：比较五套产品在年际空间变化趋势上的异同。
        

按照以上步骤，您将能够系统性地复现该研究，并对其方法和结论有更深入的理解。