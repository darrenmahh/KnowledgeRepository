# 1 SQL核心知识点综合能力测试

**说明:** 本试卷旨在全面考察您对SQL及MySQL核心原理的掌握程度。请仔细阅读题目，并结合您的理解和实践经验进行回答。总分100分，考试时间60分钟。

### 1.1.1 第一部分：数据库基础与设计 (共15分)

1. **(5分) 论述题：** 请详细阐述数据库设计的**三大范式**的核心思想。在实际项目开发中，你认为是否必须严格遵守这些范式？为什么？请举一个你认为可以适当“反范式”设计的例子并说明理由。
    
2. **(5分) 比较题：** `CHAR(10)` 和 `VARCHAR(10)` 有什么本质区别？请从**存储方式、性能开销和空间利用率**三个角度进行对比。在什么场景下你会优先选择使用 `CHAR`？
    
3. **(5分) 简答题：** 请写出SQL查询语句的**逻辑编写顺序**和MySQL内部的**实际执行顺序**。为什么理解这两个顺序的区别对写出高效的SQL很重要？
    

### 1.1.2 第二部分：存储引擎与索引核心 (共40分)

4. **(10分) 论述题：** InnoDB是目前MySQL的默认存储引擎。请解释为什么InnoDB最终选择**B+树**而不是二叉树、B树或哈希表作为其索引结构？请从**磁盘I/O、查询效率（特别是范围查询）** 等方面展开说明。
    
5. **(10分) 概念与场景题：** a. 什么是**覆盖索引 (Covering Index)**？什么是**回表 (Index Lookup)**？ b. 假设有一个用户表 `users`，包含 `id` (主键), `name`, `age`, `city` 字段。现在有一个联合索引 `idx_name_age` (`name`, `age`)。请判断以下两个查询哪个会触发回表，哪个能实现覆盖索引，并解释原因。 * `SELECT name, age FROM users WHERE name = '张三';` * `SELECT name, age, city FROM users WHERE name = '张三';`
    
6. **(10分) 场景分析题：** 假设你有一个联合索引 `idx_a_b_c` 作用于表的 `(a, b, c)` 三列。请分析以下 `WHERE` 条件中，哪些能够**完全利用**该索引，哪些只能**部分利用**，哪些**完全无法利用**，并解释其背后的“最左前缀匹配原则”。
    
    - `WHERE a = 1 AND b = 2 AND c = 3`
        
    - `WHERE a = 1 AND c = 3`
        
    - `WHERE b = 2 AND c = 3`
        
    - `WHERE a = 1 AND b > 2 AND c = 3`
        
7. **(10分) 综合应用题：** 你在为一个大型电商平台的订单表 `orders` 设计索引。该表数据量巨大，查询频繁。 a. 你会为哪些字段优先建立索引？为什么？ b. 索引的建立会带来哪些潜在的**缺点或成本**？ c. 在什么情况下，即使一个字段经常被查询，你也会**不建议**为它建立索引？（至少列出两种情况）
    

### 1.1.3 第三部分：事务处理与并发控制 (共30分)

8. **(10分) 论述题：** 什么是数据库事务？请用一个具体的例子（如银行转账）来解释事务的四大特性（ACID），并指出在InnoDB中，**原子性 (Atomicity)** 和 **持久性 (Durability)** 分别是通过什么关键技术来保证的？
    
9. **(10分) 辨析题：** 请清晰地解释**脏读、不可重复读、幻读**这三个并发问题的核心区别。MySQL的**可重复读 (Repeatable Read)** 隔离级别主要解决了哪个问题？它又是通过什么核心机制（MVCC）来解决这个问题的？
    
10. **(10分) 深入理解题：** a. MySQL的默认隔离级别是“可重复读”。它在何种程度上能够防止“幻读”？在什么情况下又无法完全避免“幻读”？ b. `UPDATE users SET age = age + 1 WHERE id = 10;` 这条单独的更新语句是原子性的吗？为什么？
    

### 1.1.4 第四部分：SQL优化实战 (共15分)

11. **(5分) 流程题：** 当你发现一条线上的SQL查询非常缓慢时，你会按照怎样的步骤去定位问题和进行优化？（请描述你的完整排查思路，需提及`慢查询日志`和`EXPLAIN`等工具）。
    
12. **(5分) 技巧题：** 为什么在很多开发规范中，都强调“不要使用 `SELECT *`”？请从**性能**和**维护性**两个角度阐述其原因。
    
13. **(5分) 场景题：** 假设一个`UPDATE`语句的`WHERE`子句中引用的列没有建立索引，这在并发场景下可能会引发什么严重问题？为什么给该列加上索引就能解决这个问题？
    

**参考答案与评分标准（仅供面试官使用）**

- **第一部分：** 考察基础概念的准确性。范式部分需答出反范式的理由（性能）。数据类型需答出存储本质。执行顺序需完全正确。
    
- **第二部分：** 考察索引的深度理解。B+树部分需与B树、哈希等做对比，突出I/O和范围查询优势。覆盖索引和回表需结合例子解释。最左前缀原则需准确判断各种场景。索引应用题考察权衡能力。
    
- **第三部分：** 考察事务和并发控制。ACID特性需与具体技术（undo/redo log）关联。并发问题辨析需清晰，并理解MVCC的作用。对可重复读隔离级别的理解深度是加分项。
    
- **第四部分：** 考察实战优化能力。慢查询排查流程需清晰、完整。对`SELECT *`的理解需全面。UPDATE锁问题能答到行锁与表锁的区别为佳。